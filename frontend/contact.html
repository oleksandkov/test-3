<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RG-FIDES ¬∑ Contact</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="icon" href="images/rg-favicon.svg" type="image/svg+xml" />
    <script defer src="app.js"></script>
    <script defer>
      window.PAGE = "contact";
    </script>
  </head>
  <body>
    <section class="hero-parallax" aria-label="Contact our team">
      <div class="hero-parallax__inner">
        <header class="topbar topbar--hero" data-menu-open="false">
          <div class="topbar__brand">
            <h1><a href="index.html">RG-FIDES</a></h1>
            <button
              type="button"
              class="topbar__toggle"
              aria-expanded="false"
              aria-controls="site-navigation"
            >
              <span class="sr-only">Toggle navigation</span>
              <span class="topbar__toggle-box" aria-hidden="true">
                <span class="topbar__toggle-line"></span>
                <span class="topbar__toggle-line"></span>
                <span class="topbar__toggle-line"></span>
              </span>
            </button>
          </div>
          <nav
            id="site-navigation"
            class="topbar__nav"
            aria-label="Primary navigation"
          >
            <a href="index.html">Home</a>
            <a href="projects.html">Projects</a>
            <a href="members.html">Team</a>
            <a href="dashboard.html" id="nav-dashboard" class="hidden"
              >Dashboard</a
            >
            <a href="admin.html" id="nav-admin" class="hidden">Admin panel</a>
            <a href="register.html" id="nav-register">Register</a>
            <a href="login.html" id="nav-login">Login</a>
            <a href="contact.html" aria-current="page">Contact Us</a>
            <button id="btn-logout" class="hidden" type="button">Logout</button>
          </nav>
        </header>
        <div class="hero-content">
          <h2 class="org-name">We'd love to hear from you</h2>
          <p class="hero-subtitle">
            Conctact with the team leader to get answers to your questions,
            discuss collaboration ideas, or explore partnership opportunities.
          </p>
        </div>
      </div>
    </section>

    <main class="container">
      <section class="contact-us">
        <div class="contact-us-header">
          <span class="section-badge">Reach the team</span>
          <h2>Write an email</h2>
          <p>
            Email will be send to the team member who is responsible for
            communication.
          </p>
        </div>
        <form id="contact-form" class="auth-form contact-form" novalidate>
          <div class="auth-field">
            <label for="contact-name">Your Name</label>
            <div class="auth-input">
              <input
                type="text"
                id="contact-name"
                name="name"
                placeholder="Jane Doe"
                required
              />
            </div>
          </div>
          <div class="auth-field">
            <label for="contact-email">Your Email</label>
            <div class="auth-input">
              <input
                type="email"
                id="contact-email"
                name="email"
                placeholder="you@example.com"
                autocomplete="email"
                required
              />
            </div>
          </div>
          <div class="auth-field">
            <label for="contact-subject">Subject</label>
            <div class="auth-input">
              <input
                type="text"
                id="contact-subject"
                name="subject"
                placeholder="Let's collaborate"
                required
              />
            </div>
          </div>
          <div class="auth-field">
            <label for="contact-message">Message</label>
            <div class="auth-input">
              <textarea
                id="contact-message"
                name="message"
                rows="6"
                placeholder="Share a short outline of your idea or question..."
                required
              ></textarea>
            </div>
          </div>
          <button type="submit" class="btn-primary">Send Email</button>
        </form>
      </section>

      <section class="contact-us">
        <div class="contact-us-header">
          <span class="section-badge">Direct channels</span>
          <h2>Prefer another route?</h2>
        </div>
        <div class="contact-us-grid">
          <article class="contact-card">
            <div class="contact-icon" aria-hidden="true">üßë‚Äçüíª</div>
            <h3>GitHub</h3>
            <p>
              Check our Github to get involved with our projects and philosophy.
            </p>
            <a
              class="contact-link"
              href="https://github.com/smallcompany"
              target="_blank"
              rel="noopener"
              >github.com/smallcompany</a
            >
          </article>
          <article class="contact-card">
            <div class="contact-icon" aria-hidden="true">üîó</div>
            <h3>LinkedIn</h3>
            <p>Connect with us professionally and follow team announcements.</p>
            <a
              class="contact-link"
              href="https://linkedin.com/company/smallcompany"
              target="_blank"
              rel="noopener"
              >linkedin.com/company/smallcompany</a
            >
          </article>
          <article class="contact-card">
            <div class="contact-icon" aria-hidden="true">üìû</div>
            <h3>Phone</h3>
            <p>Need to talk live?</p>
            <span class="contact-detail">+380931077400</span>
          </article>
        </div>
      </section>
    </main>

    <footer class="footer">
      <span>¬© <span id="year"></span> RG-FIDES</span>
      <span aria-hidden="true">‚Ä¢</span>
      <a
        class="footer-link"
        href="https://github.com/oleksandkov/oleksandkov-maded"
        target="_blank"
        rel="noopener noreferrer"
        aria-label="Open the Small Company GitHub repository"
      >
        <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path
            fill="currentColor"
            d="M12 .5a11.5 11.5 0 0 0-3.64 22.4c.57.1.78-.24.78-.55v-2.02c-3.18.69-3.85-1.53-3.85-1.53-.52-1.31-1.27-1.66-1.27-1.66-1.04-.72.08-.71.08-.71 1.15.08 1.76 1.18 1.76 1.18 1.02 1.76 2.67 1.25 3.32.96.1-.74.4-1.25.73-1.54-2.54-.29-5.2-1.27-5.2-5.64 0-1.25.45-2.27 1.18-3.07-.12-.29-.51-1.46.11-3.04 0 0 .96-.31 3.15 1.17a10.9 10.9 0 0 1 5.74 0c2.18-1.48 3.14-1.17 3.14-1.17.62 1.58.23 2.75.12 3.04.73.8 1.18 1.82 1.18 3.07 0 4.39-2.67 5.35-5.22 5.63.41.35.78 1.04.78 2.1v3.11c0 .31.21.66.79.55A11.5 11.5 0 0 0 12 .5Z"
          ></path>
        </svg>
        <span>GitHub</span>
      </a>
    </footer>

    <div id="notification-container" class="notification-container"></div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const form = document.getElementById("contact-form");
        if (!form) return;
        form.addEventListener("submit", async (event) => {
          event.preventDefault();
          if (!form.reportValidity()) {
            return;
          }

          const name = document.getElementById("contact-name").value.trim();
          const email = document.getElementById("contact-email").value.trim();
          const subject = document
            .getElementById("contact-subject")
            .value.trim();
          const message = document
            .getElementById("contact-message")
            .value.trim();

          if (!subject || !message) {
            showNotification(
              "Please include both a subject and a message before sending.",
              "error",
              "Missing details"
            );
            return;
          }

          const submitButton = form.querySelector('button[type="submit"]');
          const originalLabel = submitButton.textContent;
          const setLoading = (loading) => {
            submitButton.disabled = loading;
            submitButton.setAttribute("aria-busy", loading ? "true" : "false");
            submitButton.textContent = loading ? "Sending‚Ä¶" : originalLabel;
          };

          setLoading(true);

          const apiBase =
            window.API_BASE ||
            (window.location.hostname === "localhost" ||
            window.location.hostname === "127.0.0.1"
              ? "http://localhost:4010/api"
              : `${window.location.protocol}//${window.location.hostname}/api`);

          try {
            const response = await fetch(`${apiBase}/contact`, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({ name, email, subject, message }),
            });

            const payload = await response.json().catch(() => ({}));

            if (!response.ok) {
              const status = response.status;
              const messageText =
                payload.error ||
                (status === 503
                  ? "Email delivery is not configured."
                  : "Failed to send contact email.");
              throw Object.assign(new Error(messageText), { status });
            }

            showNotification(
              "Thanks! Your note is on its way to our inbox.",
              "success",
              "Message sent"
            );
            form.reset();
          } catch (error) {
            const status = error?.status || 0;
            if (status === 503) {
              showNotification(
                "We couldn't reach the mail service right now. Please try again soon.",
                "error",
                "Email unavailable"
              );
            } else if (error?.message === "Failed to send contact email.") {
              showNotification(
                "We couldn't send your message. Please retry in a moment.",
                "error",
                "Send failed"
              );
            } else if (error?.message) {
              showNotification(error.message, "error", "Send failed");
            } else {
              showNotification(
                "We hit an unexpected error while sending your message.",
                "error",
                "Send failed"
              );
            }
          } finally {
            setLoading(false);
          }
        });
      });
    </script>
  </body>
</html>
